<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tech Recommendation Guide Generator</title>
    <script src="https://cdn.ckeditor.com/4.22.1/standard/ckeditor.js"></script>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <h1>Tech Recommendation Guide Generator</h1>
    <label for="topic">Topic: </label>
    <input
      type="text"
      id="topic"
      placeholder="eg Nintendo Switch 2 accessories"
    />
    <label for="entries">Number of Entries: </label>
    <input type="number" id="entries" placeholder="E.g., 3" min="1" />
    <button onclick="generateContent()">Generate</button>

    <div id="generatedContent" class="hidden">
      <h2>Generated Content</h2>
      <button onclick="copyToClipboard()">Copy HTML</button>
      <br /><br />
      <textarea id="editor"></textarea>
    </div>

    <script>
      function generateContent() {
        const topic = document.getElementById("topic").value;
        const entries = parseInt(document.getElementById("entries").value) || 0;

        if (!topic || entries < 1) {
          alert("Please provide a valid topic and number of entries.");
          return;
        }

        const title = `Best ${topic}`;
        let html = `<h1>${title}</h1>\n<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>\n<ul>`;

        // Table of contents generation
        for (let i = 1; i <= entries; i++) {
          const entryId = `entry${i}`;
          html += `<li><a href="#${entryId}">Entry ${i}</a></li>`;
        }

        html += `</ul>\n<fragment slug="primis-df" />\n`; // Add <fragment slug="primis-df" />

        // Entry generation with corresponding <h2> tags having id attributes
        for (let i = 1; i <= entries; i++) {
          const entryId = `entry${i}`;
          html += `<hr />\n<table>\n<tr>\n<td>\n<h2 id="${entryId}">Best ${topic} ${i}</h2>\n<p><em>Subtitle for ${topic} ${i}</em></p>\n</td>\n<td>\n<ul>\n`;
          html += `<li><strong><a href="https://example.com/amazon-uk-${i}" rel="sponsored">Check price on Amazon UK</a></strong></li>\n`;
          html += `<li><strong><a href="https://example.com/amazon-us-${i}" rel="sponsored">Check price on Amazon US</a></strong></li>\n`;
          html += `</ul>\n</td>\n</tr>\n</table>\n`;
          html += `<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>\n`;
          html += `<ul>\n<li><strong>Pro:</strong> Advantage 1</li>\n<li><strong>Pro:</strong> Advantage 2</li>\n<li><strong>Con:</strong> Disadvantage 1</li>\n</ul>\n`;
        }

        html += `<poll />\n`; // Add <poll /> at the end

        // Reveal the editor and add the HTML to CKEditor
        document.getElementById("generatedContent").classList.remove("hidden");

        if (!CKEDITOR.instances.editor) {
          CKEDITOR.replace("editor");
        }

        const editor = CKEDITOR.instances.editor;
        editor.setData(html);
      }

      function copyToClipboard() {
        const editor = CKEDITOR.instances.editor;
        const html = editor.getData();

        navigator.clipboard
          .writeText(html)
          .then(() => {
            alert("HTML copied to clipboard!");
          })
          .catch((err) => {
            console.error("Could not copy text: ", err);
          });
      }
    </script>
  </body>
</html>
